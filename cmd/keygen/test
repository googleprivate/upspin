#!/bin/sh
# Copyright 2016 The Upspin Authors. All rights reserved.
# Use of this source code is governed by a BSD-style
# license that can be found in the LICENSE file.

function fail() {
  rm -f keygen public.upspinkey secret.upspinkey
  echo 1>&2 keygen FAILED
  exit 1
}


go build || fail

./keygen -where=. -secretseed pibud-sijat-ponam-zizaz.kudol-visin-vakok-jinok || fail
(cmp -s public.upspinkey testdata/public.test && cmp -s secret.upspinkey testdata/secret.test ) || fail

./keygen -where=. -secretseed pibud-sijat-ponam-zizaz.kudol-visin-vakok-jinok || fail
(cmp -s secret2.upspinkey testdata/secret2.test && cmp -s public.upspinkey testdata/public.test && cmp -s secret.upspinkey testdata/secret.test ) || fail

rm -f keygen public.upspinkey secret.upspinkey secret2.upspinkey
echo 1>&2 keygen PASSED

exit 0
